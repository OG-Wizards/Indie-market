<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Browse Products â€“ Indie Market</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 text-gray-800">

  <!-- Navigation Bar -->
  <nav class="bg-white shadow p-4 flex justify-between items-center">
    <a href="home.html" class="text-2xl font-bold text-blue-600">Indie Market</a>
    <div class="flex space-x-3">
      <a href="register.html" class="text-gray-700 hover:text-blue-600 transition">Seller Register</a>
      <a href="seller_dashboard.html" class="text-gray-700 hover:text-blue-600 transition">Dashboard</a>
      <a href="products.html" class="text-gray-700 hover:text-blue-600 transition font-semibold">Browse Products</a>
    </div>
  </nav>

  <!-- Filters / Search -->
  <div class="max-w-6xl mx-auto p-4 flex flex-col sm:flex-row gap-4 items-center">
    <input id="searchInput" type="text" placeholder="Search productsâ€¦" class="flex-grow border rounded px-3 py-2">
    <select id="categoryFilter" class="border rounded px-3 py-2">
      <option value="">All Categories</option>
      <option value="Skincare">Skincare</option>
      <option value="Jewelry">Jewelry</option>
      <option value="Home Decor">Home Decor</option>
      <option value="Accessories">Accessories</option>
      <option value="Bags">Bags</option>
    </select>
    <select id="sortSelect" class="border rounded px-3 py-2">
      <option value="">Sort by</option>
      <option value="price-asc">Price: Low â†’ High</option>
      <option value="price-desc">Price: High â†’ Low</option>
    </select>
  </div>

  <!-- Product Grid -->
  <section id="productGrid" class="max-w-6xl mx-auto p-4 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6"></section>

  <!-- Footer -->
  <footer class="text-center py-6 text-sm text-gray-500 bg-white">
    &copy; 2025 Indie Market. All rights reserved.
  </footer>

  <!-- Floating Cart Button -->
  <button id="cartButton" class="fixed bottom-6 right-6 bg-blue-600 text-white p-3 rounded-full shadow-lg hover:bg-blue-700 transition z-50">
    ðŸ›’ <span id="cartCount" class="ml-1 text-sm font-bold">0</span>
  </button>

  <!-- Cart Modal -->
  <div id="cartModal" class="fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center hidden z-50">
    <div class="bg-white rounded-lg shadow-lg w-full max-w-md p-6 relative">
      <h2 class="text-xl font-bold mb-4">Your Cart</h2>
      <div id="cartItems" class="space-y-4 max-h-64 overflow-y-auto"></div>
      <div class="mt-4 text-right">
        <strong>Total: â‚¹<span id="cartTotal">0</span></strong>
      </div>
      <button class="mt-6 w-full bg-green-600 text-white py-2 rounded hover:bg-green-700">Checkout</button>
      <button id="closeCart" class="absolute top-3 right-3 text-gray-500 hover:text-red-500">âœ•</button>
    </div>
  </div>

  <!-- Product & Cart Scripts -->
  <script>
    let allProducts = [];
    const grid = document.getElementById("productGrid");
    const searchInput = document.getElementById("searchInput");
    const categoryFilter = document.getElementById("categoryFilter");
    const sortSelect = document.getElementById("sortSelect");

    // Fetch products from backend
    async function fetchProducts() {
      try {
        const res = await fetch("http://localhost:3000/products");
        const data = await res.json();
        allProducts = data;
        renderProducts(allProducts);
      } catch (err) {
        grid.innerHTML = "<p class='text-red-500'>Failed to load products.</p>";
      }
    }

    function renderProducts(list) {
      grid.innerHTML = "";
      list.forEach(p => {
        const card = document.createElement("div");
        card.className = "bg-white rounded-lg shadow hover:shadow-lg transform hover:-translate-y-1 transition duration-300 group overflow-hidden";
        card.innerHTML = `
          <img src="${p.image}" alt="${p.name}" class="w-full h-48 object-cover group-hover:scale-105 transition-transform duration-300">
          <div class="p-4">
            <h3 class="text-lg font-semibold">${p.name}</h3>
            <p class="text-gray-500">${p.category}</p>
            <p class="text-blue-600 font-bold mt-2">â‚¹${p.price}</p>
            <p class="text-sm text-gray-700 mt-1">${p.description}</p>
            <button class="mt-4 w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700 transition transform hover:scale-105 add-to-cart"
              data-product='${JSON.stringify(p)}'>
              Add to Cart
            </button>
          </div>`;
        grid.appendChild(card);
      });

      // Add to Cart buttons
      document.querySelectorAll(".add-to-cart").forEach(btn => {
        btn.addEventListener("click", () => {
          const product = JSON.parse(btn.dataset.product);
          addToCart(product);
        });
      });
    }

    function applyFilters() {
      let filtered = [...allProducts];
      const query = searchInput.value.toLowerCase();
      const selectedCategory = categoryFilter.value;

      filtered = filtered.filter(p =>
        p.name.toLowerCase().includes(query) &&
        (selectedCategory === "" || p.category === selectedCategory)
      );

      if (sortSelect.value === "price-asc") {
        filtered.sort((a, b) => a.price - b.price);
      } else if (sortSelect.value === "price-desc") {
        filtered.sort((a, b) => b.price - a.price);
      }

      renderProducts(filtered);
    }

    searchInput.addEventListener("input", applyFilters);
    categoryFilter.addEventListener("change", applyFilters);
    sortSelect.addEventListener("change", applyFilters);

    // Initial load
    fetchProducts();
  </script>

  <!-- Cart Script -->
  <script>
    let cart = [];

    function updateCart() {
      const cartItems = document.getElementById("cartItems");
      const cartCount = document.getElementById("cartCount");
      const cartTotal = document.getElementById("cartTotal");

      cartItems.innerHTML = "";
      let total = 0;

      cart.forEach((item, index) => {
        total += item.price;
        const div = document.createElement("div");
        div.className = "border p-3 rounded flex justify-between items-start";
        div.innerHTML = `
          <div>
            <p class="font-semibold">${item.name}</p>
            <p class="text-sm text-gray-600">â‚¹${item.price}</p>
          </div>
          <button onclick="removeFromCart(${index})" class="text-red-500 hover:text-red-700">Remove</button>
        `;
        cartItems.appendChild(div);
      });

      cartCount.textContent = cart.length;
      cartTotal.textContent = total;
    }

    function addToCart(product) {
      cart.push(product);
      updateCart();
    }

    function removeFromCart(index) {
      cart.splice(index, 1);
      updateCart();
    }

    document.getElementById("cartButton").addEventListener("click", () => {
      document.getElementById("cartModal").classList.remove("hidden");
    });

    document.getElementById("closeCart").addEventListener("click", () => {
      document.getElementById("cartModal").classList.add("hidden");
    });
  </script>
  <script>
  async function fetchProducts() {
    try {
      const response = await fetch("http://localhost:5000/api/products");
      const products = await response.json();
      renderProducts(products);
    } catch (error) {
      console.error("Error fetching products:", error);
    }
  }

  function renderProducts(products) {
    const container = document.getElementById("productContainer");
    container.innerHTML = "";

    products.forEach((product) => {
      const card = document.createElement("div");
      card.classList.add("product-card");

      card.innerHTML = `
        <img src="${product.image}" alt="${product.name}" />
        <h3>${product.name}</h3>
        <p>${product.description}</p>
        <span>â‚¹${product.price}</span>
        <button onclick="addToCart('${product._id}')">Add to Cart</button>
      `;

      container.appendChild(card);
    });
  }

  fetchProducts();
</script>
<script>
  async function fetchProducts() {
    try {
      const res = await fetch("http://localhost:3000/api/products");

      const products = await response.json();

      const productList = document.getElementById("productList");
      productList.innerHTML = ""; // Clear any existing content

      products.forEach(product => {
        const productCard = document.createElement("div");
        productCard.className = "bg-white shadow rounded p-4 hover:shadow-md transition";

        productCard.innerHTML = `
          <img src="${product.image}" alt="${product.name}" class="w-full h-48 object-cover rounded mb-4">
          <h3 class="text-lg font-semibold">${product.name}</h3>
          <p class="text-gray-600 mb-2">${product.description}</p>
          <p class="text-blue-600 font-bold mb-4">â‚¹${product.price}</p>
          <button class="add-to-cart bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">Add to Cart</button>
        `;

        productList.appendChild(productCard);
      });

    } catch (error) {
      console.error("Failed to fetch products:", error);
    }
  }

  // Call fetchProducts on page load
  window.addEventListener("DOMContentLoaded", fetchProducts);
</script>

</body>
</html>

